# vim:fileencoding=utf-8:ft=yaml:foldmethod=indent

profiles:
  "*":
    - cli

  gui:
    - apps

  rice:
    - hyprland
    - waybar
    - xremap

  work:
    - work

config:
  cli:
    git:
      install:
        brew: "brew install git git-delta gh"
        dnf: |
          sudo dnf config-manager --add-repo https://cli.github.com/packages/rpm/gh-cli.repo
          sudo dnf install gh git-delta git
        apt: |
          (type -p wget >/dev/null || (sudo apt update && sudo apt install wget -y)) \
          && sudo mkdir -p -m 755 /etc/apt/keyrings \
          && out=$(mktemp) && wget -nv -O$out https://cli.github.com/packages/githubcli-archive-keyring.gpg \
          && cat $out | sudo tee /etc/apt/keyrings/githubcli-archive-keyring.gpg > /dev/null \
          && sudo chmod go+r /etc/apt/keyrings/githubcli-archive-keyring.gpg \
          && sudo mkdir -p -m 755 /etc/apt/sources.list.d \
          && echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null \
          && sudo apt update \
          && sudo apt install gh git-delta git -y
      link:
        "./config/git/gitconfig": "~/.gitconfig"
        "./config/git/gh.yml": "~/.config/gh/config.yml"
      postinstall: |
        gh auth status | grep 'Logged in to github.com account' > /dev/null || gh auth login --web -h github.com
        gh extension list | grep gh-copilot > /dev/null || gh extension install github/gh-copilot

    zsh:
      install:
        apt: "sudo apt install -y fd-find jq tldr tree vim wget zoxide zsh"
        dnf: "sudo dnf install -y fd-find jq tldr tree vim wget zoxide zsh"
        brew: "brew install fd jq tldr tree vim wget zoxide zsh"
      link:
        "./config/zsh/zshrc": "~/.zshrc"
        "./config/zsh/zimrc": "~/.zimrc"
        "./config/zsh/functions": "~/.zsh/functions"
        "./config/zsh/zshrc.d/00-path.sh": "~/.zshrc.d/00-path.sh"
        "./config/zsh/zshrc.d/10-aliases.sh": "~/.zshrc.d/10-aliases.sh"
        "./config/zsh/zshrc.d/20-core-functions.sh": "~/.zshrc.d/20-core-functions.sh"
        "./config/zsh/zshrc.d/30-completions.sh": "~/.zshrc.d/30-completions.sh"
        "./config/zsh/zshrc.d/50-zoxide.sh": "~/.zshrc.d/50-zoxide.sh"
        "./config/zsh/zshrc.d/60-zsh-ai.sh": "~/.zshrc.d/60-zsh-ai.sh"
        "./config/zsh/zshrc.d/99-java.sh": "~/.zshrc.d/99-java.sh"
      postinstall: |
        [[ -d ~/.zim/ ]] || curl -fsSL https://raw.githubusercontent.com/zimfw/install/master/install.zsh | zsh

    zsh-ai:
      install:
        brew: "brew tap matheusml/zsh-ai && brew install zsh-ai"

    tmux:
      install:
        brew: "brew install tmux bash"
        apt: "sudo apt install -y tmux"
        dnf: "sudo dnf install -y tmux"
      link:
        "./config/tmux/tmux.conf": "~/.tmux.conf"
      postinstall: "[ -d ~/.tmux/plugins ] || mkdir -p ~/.tmux/plugins"

    vim:
      install:
        brew: "brew install vim"
        apt: "sudo apt install -y vim"
        dnf: "sudo dnf install -y vim"
      link:
        "./config/vim/vimrc": "~/.vimrc"

    neovim:
      install:
        brew: "brew install neovim"
        apt: |
          sudo apt install software-properties-common -y
          sudo add-apt-repository ppa:neovim-ppa/unstable -y
          sudo apt update -y
          sudo apt install neovim -y
        dnf: "sudo dnf install -y neovim"
      uninstall:
        brew: "brew uninstall neovim"
        apt: |
          sudo add-apt-repository -r ppa:neovim-ppa/unstable
          sudo apt purge -y neovim
        dnf: "sudo dnf remove -y neovim"
      link:
        "./config/neovim/init.lua": "~/.config/nvim/init.lua"

    btop:
      install:
        brew: "brew install btop"
        apt: "sudo apt install -y btop"
        dnf: "sudo dnf install -y btop"

    mise:
      install:
        brew: "brew install mise"
        curl: "curl https://mise.run | sh"
      link:
        "./config/mise/config.toml": "~/.config/mise/config.toml"
        "./config/zsh/zshrc.d/40-mise.sh": "~/.zshrc.d/40-mise.sh"
      postinstall: "cd ~ && mise install"

    editorconfig:
      link:
        "./config/editorconfig/editorconfig": "~/.editorconfig"

    ripgrep:
      install:
        brew: "brew install ripgrep"
        apt: "sudo apt install -y ripgrep"
        dnf: "sudo dnf install -y ripgrep"
      uninstall:
        brew: "brew uninstall ripgrep"
        apt: "sudo apt purge -y ripgrep"
        dnf: "sudo dnf remove -y ripgrep"
      link:
        "./config/ripgrep/ripgreprc": "~/.ripgreprc"

    binaries:
      link:
        "./config/binaries": "~/.bin"

    opencode:
      install:
        curl: "curl -fsSL https://opencode.ai/install | bash"
      uninstall:
        opencode: "opencode uninstall"
      link:
        "./config/opencode/opencode.jsonc": "~/.config/opencode/opencode.jsonc"
        "./config/opencode/oh-my-opencode.json": "~/.config/opencode/oh-my-opencode.json"
        "./config/opencode/plugins": "~/.opencode/plugins"

    agents:
      link:
        "./config/agents": "~/.agents"

    pi:
      install:
        bun: "bun i -g @mariozechner/pi-coding-agent"
      uninstall:
        bun: "bun rm -g @mariozechner/pi-coding-agent"

    macmon:
      os: ["mac"]
      install:
        brew: "brew install macmon"

    coreutils:
      os: ["mac"]
      install:
        brew: "brew install coreutils"

  apps:
    cursor:
      os: ["mac"]
      install:
        brew: "brew install cursor"
      link:
        "./config/cursor/settings.json": "~/Library/Application Support/Cursor/User/settings.json"
        "./config/cursor/keybindings.json": "~/Library/Application Support/Cursor/User/keybindings.json"

    zed:
      os: ["mac"]
      install:
        brew: "brew install zed"
      link:
        "./config/zed/settings.json": "~/.config/zed/settings.json"
        "./config/zed/keymap.json": "~/.config/zed/keymap.json"

    "1password":
      os: ["mac"]
      install:
        brew: "brew install 1password"

    ice:
      os: ["mac"]
      install:
        brew: "brew install ice"
      defaults:
        "com.jordanbaird.Ice": "./config/ice/Ice.xml"

    stats:
      os: ["mac"]
      install:
        brew: "brew install --cask stats"
      uninstall:
        brew: "brew uninstall --cask stats"
      defaults:
        "eu.exelban.Stats": "./config/stats/Stats.xml"

    battery:
      os: ["mac"]
      install:
        brew: "brew install battery"
      postinstall: "open /Applications/Battery.app"

    ghostty:
      os: ["mac"]
      install:
        brew: "brew install ghostty"
        dnf: "sudo dnf install -y ghostty"
      uninstall:
        brew: "brew uninstall ghostty"
        dnf: "sudo dnf remove -y ghostty"
      link:
        "./config/ghostty/config": "~/.config/ghostty/config"

    shortcat:
      os: ["mac"]
      install:
        brew: "brew install shortcat"
      uninstall:
        brew: "brew uninstall shortcat"

    karabiner:
      os: ["mac"]
      install:
        brew: "brew install karabiner-elements"
      link:
        "./config/karabiner/karabiner.json": "~/.config/karabiner/karabiner.json"

    aerospace:
      os: ["mac"]
      install:
        brew: "brew install aerospace"
      link:
        "./config/aerospace/aerospace.toml": "~/.config/aerospace/aerospace.toml"

    wallpapers:
      link:
        "./config/wallpapers": "~/.config/wallpapers"
      postlink: |
        if [[ $(uname -s) == "Darwin" ]]; then # i use hyprpaper on linux
          wallpaper="audi.jpg"
          img_path="${HOME}/.config/wallpapers/${wallpaper}"
          osascript -e "tell application \"Finder\" to set desktop picture to POSIX file \"${img_path}\""
        fi

    mos:
      os: ["mac"]
      install:
        brew: "brew install mos"
      defaults:
        "com.caldis.Mos": "./config/mos/Mos.xml"

    raycast:
      os: ["mac"]
      install:
        brew: "brew install raycast"

    swiftshift:
      os: ["mac"]
      install:
        brew: "brew install swift-shift"
      defaults:
        "com.pablopunk.Swift-Shift": "./config/swiftshift/SwiftShift.xml"

    tailscale:
      os: ["mac"]
      install:
        brew: "brew install tailscale"

    telegram:
      os: ["mac"]
      install:
        brew: "brew install telegram"

    whatsapp:
      os: ["mac"]
      install:
        brew: "brew install whatsapp"

    missive:
      os: ["mac"]
      install:
        brew: "brew install missive"

  hyprland:
    os: ["linux"]
    install:
      dnf: "sudo dnf install -y hyprland ulauncher copyq hyprshot"
    link:
      "./config/hypr": "~/.config/hypr"
      "./config/ulauncher/": "~/.config/ulauncher"

  waybar:
    os: ["linux"]
    install:
      dnf: "sudo dnf install -y waybar"
    link:
      "./config/waybar": "~/.config/waybar"

  xremap:
    os: ["linux"]
    install:
      cargo: "cargo install xremap --features hypr"
    uninstall:
      cargo: "cargo uninstall xremap"
    link:
      "./config/xremap/config.yml": "~/.config/xremap/config.yml"

  work:
    cloudflare-warp:
      os: ["mac"]
      install:
        brew: "brew install cloudflare-warp"

    monitorcontrol:
      os: ["mac"]
      install:
        brew: "brew install monitorcontrol"

    orbstack:
      os: ["mac"]
      install:
        brew: "brew install orbstack"

    slack:
      os: ["mac"]
      install:
        brew: "brew install slack"

    zoom:
      os: ["mac"]
      install:
        brew: "brew install zoom"

    cleanshot:
      os: ["mac"]
      install:
        brew: "brew install cleanshot"
