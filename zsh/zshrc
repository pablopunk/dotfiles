# Fig pre block. Keep at the top of this file.
[[ -f "$HOME/.fig/shell/zshrc.pre.zsh" ]] && builtin source "$HOME/.fig/shell/zshrc.pre.zsh"
#
# OH-MY-ZSH
#
export ZSH="$HOME/.oh-my-zsh"
ZSH_THEME=""
plugins=(
  git
  macos
  npm
)
source /opt/homebrew/share/zsh-autosuggestions/zsh-autosuggestions.zsh
source /opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
source $ZSH/oh-my-zsh.sh

#
# ZSH OPTIONS
#
setopt PROMPT_SUBST

#
# MODULAR
#
source ~/.functions
source ~/.aliases
source ~/.path
F=$HOME/.additional; [ -f $F ] && . $F # aditional local config

#
# PROMPT
#
NEWLINE=$'\n'
PROMPT='$(bashy -r)${NEWLINE}%F{yellow}Æ›%f '

TERM=xterm-256color

#
# VSCODE ALWAYS ON TMUX AND SSH
#
[ "$TERM_PROGRAM" = "vscode" ] && [ ! -z "$TMUX" ] && ( tmux a || tmux )
[ ! -z "$SSH_CONNECTION" ] && [ ! -z "$TMUX" ] && ( tmux a || tmux )


export PNPM_HOME="/Users/pablopunk/Library/pnpm"
export PATH="$PNPM_HOME:$PATH"

#
# KITTY DARK/LIGHT MODE
#
current_theme=$(cat $HOME/.theme 2>/dev/null || echo Dark)
if [[ ! ( $(2>/dev/null defaults read -g AppleInterfaceStyle) =~ 'Dark' ) ]]; then
  new_theme=Light
  kitty_theme="Pencil Light"
else
  new_theme=Dark
  kitty_theme="Xcodedark"
fi
if [[ $current_theme != $new_theme ]]; then
  kitty +kitten themes --reload-in=all $kitty_theme
  echo $new_theme > $HOME/.theme
fi

# bun completions
[ -s "/Users/pablopunk/.bun/_bun" ] && source "/Users/pablopunk/.bun/_bun"

# asdf
. /opt/homebrew/opt/asdf/libexec/asdf.sh
. /opt/homebrew/opt/asdf/etc/bash_completion.d/asdf.bash
