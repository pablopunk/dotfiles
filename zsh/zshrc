#
# OH-MY-ZSH
#
export ZSH="$HOME/.oh-my-zsh"
ZSH_THEME=""
plugins=(
  git
  macos
)

#
# MODULAR
#
source ~/.functions
source ~/.aliases
source ~/.path
F=$HOME/.additional; [ -f $F ] && . $F # aditional local config

#
# ZSH OPTIONS
#
source $HOMEBREW_PREFIX/share/zsh-autosuggestions/zsh-autosuggestions.zsh
source $HOMEBREW_PREFIX/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
source $ZSH/oh-my-zsh.sh
setopt PROMPT_SUBST

#
# PROMPT
#
NEWLINE=$'\n'
PROMPT='$(bashy -r)${NEWLINE}%F{yellow}Æ›%f '

TERM=xterm-256color

#
# VSCODE ALWAYS ON TMUX AND SSH
#
[ "$TERM_PROGRAM" = "vscode" ] && [ -z "$TMUX" ] && ( tmux a || tmux )
[ ! -z "$SSH_CONNECTION" ] && [ -z "$TMUX" ] && ( tmux a || tmux )


export PNPM_HOME="/Users/pablopunk/Library/pnpm"
export PATH="$PNPM_HOME:$PATH"

#
# KITTY DARK/LIGHT MODE
#
current_theme=$(cat $HOME/.theme 2>/dev/null || echo Dark)
if [[ $(uname) == "Darwin" ]]; then
  defaults read -g AppleInterfaceStyle 2>&- >&-
  if [[ $? == 1 ]]
  then
    new_theme=Light
    kitty_theme="Catppuccin-Latte"
  else
    new_theme=Dark
    kitty_theme="Catppuccin-Mocha"
  fi
  if [[ $current_theme != $new_theme ]]
  then
    kitty +kitten themes --reload-in=all $kitty_theme
    echo $new_theme > $HOME/.theme
  fi
fi

# bun completions
[ -s "~/.bun/_bun" ] && source "~/.bun/_bun"

# asdf
. $HOMEBREW_PREFIX/opt/asdf/libexec/asdf.sh
. $HOMEBREW_PREFIX/opt/asdf/etc/bash_completion.d/asdf.bash
